title: به روز رسانی برنامه ها در ابونتو به صورت off-line
briefing: تا به حال شده که به خاطر تعدد دفعات update بسته های ubuntu (ماهی چند نوبت)، حجم حساب اینترنتی شما تمام شده باشد؟
date_time: 2013-03-23 23:55
slug: update_ubuntu_offline
tags: ubuntu, linux, apt
type: post

تا به حال شده که به خاطر تعدد دفعات `update` بسته های `ubuntu` (ماهی چند نوبت)، حجم حساب اینترنتی شما تمام شده باشد؟ به خصوص این که اگر چند رایانه داشته باشید که روی همه آنها اوبونتو نصب باشد که آن وقت مشکل دوچندان می شود. چرا که اگر بخواهید تمام آن رایانه ها به روز باشند. بنده خودم خیلی با این موضوع سر و کار دارم، به همین خاطر با جستجو در اینترنت توانستم چند راه برای این موضوع پیدا کنم.

در این نوشته فرض بر این است که حداقل یک سیستم به اینترنت متصل می باشد و دیگری نیست. و بر روی تمامی رایانه ها سیستم عامل [Ubuntu][Ubuntu] نصب می باشد.

###راه اول: بوسیله برنامه Synaptic Package Manager

در این بخش ضمن معرفی برنامه ای قدرتمند برای مدیریت بسته های نرم افزاری سیستم عامل ابونتو، آن را نصب و طریقه انجام آپدیت را شرح می دهیم.
  - برای نصب این برنامه مفید فقط کافی است تا در ترمینال رایانه ای که به اینتر نت متصل است، فرمان زیر را اجرا نمایید:

    sudo apt-get install synaptic

  * سپس با استفاده از فرمان زیر در ترمینال مخازن را ببه روز رسانی کنید:

    sudo apt-get update

  * بعد از آن برنامه `Synaptic Package Manager` را اجرا کرده و دکمه `"Mark All Upgrades"` را بزنید تا تمامی بسته ها برای آپدیت انتخاب شوند.

![Synaptec Package Manager](http://i.stack.imgur.com/99tff.png)

  * اگر از شما برای انتخاب بسته های لازم اضافه سوال کرد، شما دکمه` "Mark`" را بزنید تا آن بسته ها نیز انتخاب شوند.

![Additional Packages](http://i.stack.imgur.com/FEwxP.png)

  * در نهایت دکمه `"Apply"` را بزنید تا برنامه شروع به آپیدت بسته های نرم افزاری موجود بکند.

  * بعد از اتمام به روز رسانی یه شاخه به نام `update` در مسیر خانه کاربرتان ایجاد کرده و، `"File -> Generate package download script"` را در برنامه `synaptec` انتخاب نموده و در پنجره باز شده آدرس مسیر `update` را که ایجاد کرده بودید به آن داده و نام فایل را به آن اختصاص دهید سپس آن را ذخیره کنید، در اینجا ما نام فایل را `update-offline.sh` می گزاریم.

  * از طریق برنامه ترمینال به مسیر `update` که ایجاد کردید بروید و در آن جا فرمان زیر را اجرا کنید:

    cp /var/cache/apt/archives/*.deb .

با این دستور تمامی فایلهایی که سیستم فعلی که به اینترنت متصل بوده را آپدیت کرده اند و پسوند آنها `deb.` می باشد، را به مسیر ایجاد شده `update` منتقل می کند.

  * شاخه `update` که اکنون حاوی تمامی فایل های `deb.` برای آپدیت می باشد را بوسیله `USB` فلش یا `CD` یا `DVD` می توانید به سیستم یا سیستم های دیگر که به اینترنت متصل نیستند منتقل کنید.

  * اکنون بر روی سیستم (یا سیستم هایی) که به اینترنت متصل نیستند در مسیر خانه کاربر یک شاخه به نام `offline` ایجاد کنید و شاخه `update` را داخل آن بریزید. به این ترتیب ساختار آن باید به شکل زیر باشد:

    + home
     +- username
       +-  offline
         +-  Updates (contains the .deb files)

  * در سیستمی که به انترنت متصل نمی باشد، برنامه ترمینال را اجرا کرده و به شاخه `offline` رفته و در آنجا دستور زیر را اجرا کنید تا فایل شاخص برای بسته های موجود تهیه شود:

    apt-ftparchive packages . > Packages

اکنون در آنجا شما یه فایل به نام `Packages` مشاهده می کنید.

  * حالا باید فایل `source.list` را با دسترسی `root` باز کنید:

    gksu gedit /etc/apt/sources.list

  * به محض باز شدن فایل در همان بالا آن، دکمه `"Enter"` را بزنید تا یک خط خالی باز شود و در آن خط متن زیر را اضافه کنید و فایل را ذخیره نمایید:

    deb file:/home/username/offline /

توجه کنید که کلمه `username` که در خط بالا آمده است باید با نام کاربری که در آن سیستم لاگین می کنید جابجا شود.

نکته: برای راحتی بیشتر و اگر که این رایانه هرگز به اینترنت قرار نیست که متصل شود می توانید ابتدای دیگر خطوط موجود در این فایل را علامت `#` قرار دهید تا دیگر مخازن برای به روز رسانی غیر فعال شوند.

  * اکنون کافی است تا برای آپدیت اوبونتوی خود دستور زیر را اجرا کنید:

    sudo apt-get update
    sudo apt-get upgrade

خوب این یک راه برای آپدیت `offline` سیستم عامل اوبونتوی رایانه تان بود.

####راه دوم: استفاده از برنامه apt-offline

این برنامه هم قابل اجرا در حالت خط فرمانی `(CLI)`، و هم در حالت گرافیکی می باشد. با در نظر گرفتن فرضیات بالا به ترتیب زیر عمل می کنیم:
  * ابتدا این برنامه را هم روی رایانه ای که به اینترنت متصل است و هم رایانه ای که به اینترنت متصل نیست به صورت زیر نصب می کنیم:

    sudo apt-get install apt-offline apt-offline-gui

  * برای راحتی بیشتر از طریق ترمینال دستور زیر را در رایانه ای که به اینترنت متصل نیست زده تا برنامه اجرا شود:

    sudo apt-offline-gui

  * در پنجره باز شده گزینه اول `"Generate Signature"` را زده و یه فایل `sig.` را ایجاد می کنیم.

  * آن فایل ایجاد شده را به رایانه ای که اینترنت دارد منتقل می کنیم. در آن رایانه نیز همان برنامه `aptt-offline-gui` را همانطور که در بالا گفتیم اجرا کرده و گزینه `"Download Packages or Updates"` را زده و در آن آدرس فایل `sig.` منتقل شده را داد و مسیر ذخیر آپدیت را مشخص کرده و سپس دکمه `Download` را می زنیم.

  * پس از اتمام دانلود آپدیت ها، فایل آپدیت ذخیره شده را به رایانه اول منتقل می کنیم.

  * در رایانه ای که اینترنت متصل نیست در بنامه `apt-offline-gui` گزینه `"Install Packages or Updates"` را زده و در آنجا مسیر فایل آپدیت منتقل شده را داده و دکمه `"Install"` را می زنیم.

  * اکنون برنامه شروع به آپدیت سیستم کرده

البته برای انجام این کار راههای دیگری هم هستند که اگر انشاء الله به آنها دست یافتیم، آنها را نیز توضیح می دهیم.

[Ubuntu]: https://en.wikipedia.org/wiki/Ubuntu_(operating_system)  "Ubuntu_(Linux_operating_system)"
